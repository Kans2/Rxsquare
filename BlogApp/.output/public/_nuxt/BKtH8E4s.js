import{_ as v}from"./Bt3fWRG6.js";import{q as w,c as i,o as n,a as e,t as _,b as m,w as f,d as g,j as k,p as x,s as d,F as $,x as D,y as P}from"#entry";import{u as B}from"./CWJC2qwD.js";import{_ as L}from"./DlAUqK2U.js";import{u as N}from"./CH4rY200.js";const C={class:"blog-card"},E=["src","alt"],A={class:"blog-card-content"},F={class:"card-footer"},V={class:"blog-card-date"},S={class:"actions"},T={__name:"BlogPostCard",props:{post:{type:Object,required:!0}},emits:["post-deleted"],setup(t,{emit:a}){const l=t,r=a;w(()=>{const o={year:"numeric",month:"long",day:"numeric"};return new Date(l.post.date).toLocaleDateString("en-US",o)});const u=async()=>{if(confirm("Are you sure you want to delete this post?")){const{data:o,error:s}=await B(`/api/blog/${l.post.id}`,{method:"DELETE"},"$VuZMQ1LWuT");o.value&&o.value.success?(alert("Post deleted successfully!"),r("post-deleted",l.post.id)):alert("Error deleting post: "+(s.value?.message||"Unknown error"))}};return(o,s)=>{const p=v;return n(),i("div",C,[e("img",{src:t.post.imageUrl,alt:t.post.title},null,8,E),e("div",A,[e("h2",null,_(t.post.title),1),e("p",null,_(t.post.description),1),e("div",F,[e("span",V,_(t.post.date),1),m(p,{to:`/blog/view/${t.post.id}`,class:"view-link"},{default:f(()=>[...s[0]||(s[0]=[g(" Click here to view full blog ",-1)])]),_:1},8,["to"])])]),e("div",S,[m(p,{to:`/blog/edit/${t.post.id}`,class:"edit-btn"},{default:f(()=>[...s[1]||(s[1]=[g("Edit",-1)])]),_:1},8,["to"]),e("button",{onClick:k(u,["prevent"]),class:"delete-btn"},"Delete")])])}}},U=L(T,[["__scopeId","data-v-0c45f994"]]),j={class:"content-container"},q={key:0},M={key:1},I={key:2,class:"blog-list"},G={__name:"index",async setup(t){let a,l;const{data:r,pending:u,error:o,refresh:s}=([a,l]=x(()=>N("posts",()=>$fetch("/api/blog"))),a=await a,l(),a);return o.value&&console.error("Failed to fetch posts:",o.value),(p,c)=>{const b=v,y=U;return n(),i("div",j,[c[1]||(c[1]=e("h1",null,"All Blog Posts",-1)),m(b,{to:"/blog/new",class:"add-post-btn"},{default:f(()=>[...c[0]||(c[0]=[g("Add New Post",-1)])]),_:1}),d(u)?(n(),i("div",q,"Loading posts...")):!d(r)||d(r).length===0?(n(),i("div",M,"No blog posts found.")):(n(),i("div",I,[(n(!0),i($,null,D(d(r),h=>(n(),P(y,{key:h.id,post:h,onPostDeleted:d(s)},null,8,["post","onPostDeleted"]))),128))]))])}}};export{G as default};
