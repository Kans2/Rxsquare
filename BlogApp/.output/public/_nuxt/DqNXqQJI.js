import{_ as h}from"./Bt3fWRG6.js";import{r as v,n as k,g as I,p as N,m as P,c as i,a as t,j as C,k as _,l as m,v as g,b as V,w as F,o as r,d as $}from"#entry";import{u as b}from"./CWJC2qwD.js";import"./CH4rY200.js";const D={class:"form-page-container"},S={class:"form-content-wrapper"},T={key:0},B={class:"form-group"},E={class:"form-group"},q={class:"form-group"},L={key:0,style:{color:"blue"}},O={key:1,style:{"margin-top":"10px"}},R=["src"],j={class:"form-group"},A={class:"form-buttons"},J=["disabled"],K={__name:"[id]",async setup(M){let l,c;const y=k(),f=P(),n=v(!1),p=parseInt(y.params.id),d=v(null),o=I({title:"",description:"",imageUrl:"",date:""}),{data:U,error:H}=([l,c]=N(()=>b(`/api/blog/${p}`,"$AJ-CHgtSFS")),l=await l,c(),l);d.value=U.value,d.value?Object.assign(o,d.value):f.push("/blog");const w=async a=>{const e=a.target.files[0];if(!e)return;n.value=!0;const u=new FormData;u.append("image",e);try{const{imageUrl:s}=await $fetch("/api/upload",{method:"POST",body:u});s&&(o.imageUrl=s)}catch(s){alert("Failed to upload image: "+s.message)}finally{n.value=!1}},x=async()=>{if(!o.imageUrl){alert("Please upload an image or provide an image URL.");return}const{data:a,error:e}=await b(`/api/blog/${p}`,{method:"PUT",body:JSON.stringify(o)},"$bIUIEQYn-b");a.value&&a.value.success?(alert("Post updated successfully!"),f.push(`/blog/${p}`)):alert("Error updating post: "+(e.value?.message||"Unknown error"))};return(a,e)=>{const u=h;return r(),i("div",D,[t("div",S,[e[9]||(e[9]=t("h1",null,"Edit Blog Post",-1)),d.value?(r(),i("form",{key:1,onSubmit:C(x,["prevent"])},[t("div",B,[e[3]||(e[3]=t("label",{for:"title"},"Title",-1)),m(t("input",{type:"text",id:"title","onUpdate:modelValue":e[0]||(e[0]=s=>o.title=s),required:""},null,512),[[g,o.title]])]),t("div",E,[e[4]||(e[4]=t("label",{for:"description"},"Description",-1)),m(t("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=s=>o.description=s),required:""},null,512),[[g,o.description]])]),t("div",q,[e[5]||(e[5]=t("label",{for:"image"},"Upload New Image (optional)",-1)),t("input",{type:"file",id:"image",onChange:w,accept:"image/*"},null,32)]),n.value?(r(),i("div",L,"Uploading image...")):_("",!0),o.imageUrl?(r(),i("div",O,[e[6]||(e[6]=t("p",null,"Current/New Image Preview:",-1)),t("img",{src:o.imageUrl,alt:"Post Image",style:{"max-width":"200px","max-height":"200px"}},null,8,R)])):_("",!0),t("div",j,[e[7]||(e[7]=t("label",{for:"date"},"Date",-1)),m(t("input",{type:"date",id:"date","onUpdate:modelValue":e[2]||(e[2]=s=>o.date=s),required:""},null,512),[[g,o.date]])]),t("div",A,[t("button",{type:"submit",disabled:n.value},"Update Post",8,J),V(u,{to:"/blog/view/{{postId}}"},{default:F(()=>[...e[8]||(e[8]=[$("Cancel",-1)])]),_:1})])],32)):(r(),i("div",T,"Loading..."))])])}}};export{K as default};
